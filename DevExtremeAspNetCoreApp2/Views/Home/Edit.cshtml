@model DevExtremeAspNetCoreApp2.Models.OfficeSurveyModel

@{
    ViewData["Title"] = "Edit Office Details";
}


<html>
<head>
    <meta charset="UTF-8">
    <title>TRC Sustainability</title>
    @* <link rel="stylesheet" href="styles.css"> *@
</head>
<body>
    <header class="header">
        <div class="top-bar">
            <img src="/images/logo-white.svg" alt="TRC Logo" class="logo" />
        </div>
        <div class="nav-bar">
            <div class="app-title">Sustainability Application</div>
            <nav class="nav-links">
                <a href="@Url.Action("Index", "Home")" class="active">Location Info</a>
                <a href="@Url.Action("Index", "MeterReading")">Meter Reading</a>
                <a href="#">Coordinators</a>
                <a href="#">Good Practices</a>
                <a href="#">2025 Earth Day Challenge</a>
                <a href="#">IBT</a>
                <a href="#">Paper Usage</a>
            </nav>
        </div>
    </header>
    <main class="main-container">

        <h3>EDIT OFFICE INFORMATION</h3>
        <div class="card-box">
        <div id="myFormWrapper" class="tight-form">
        <div id="formContainer" style="margin: 20px;"></div>
        </div>
        <div id="saveBtn" style="margin-top: -120px;margin-left:525px"></div>
        </div>
    </main>
<!-- Include DevExtreme resources if not already -->
<!-- jQuery first -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- DevExtreme CSS -->
@* <link rel="stylesheet" href="https://cdn3.devexpress.com/jslib/22.2.15/css/dx.light.css" /> *@
<link href="~/css/devextreme/dx.light.css" rel="stylesheet" />

<!-- DevExtreme JS -->
@* <script src="https://cdn3.devexpress.com/jslib/22.2.15/js/dx.all.js"></script> *@
<script src="~/js/devextreme/dx.all.js"></script>



<script>
    $(function () {
        debugger;
            var formData = @Html.Raw(Json.Serialize(Model));

    console.log("Form Data:", formData);
                            
                //console.log("RecycleGlassBool = " + model.RecycleGlassBool);
                $("#formContainer").dxForm({
            formData: @Html.Raw(Json.Serialize(Model)),
                onFieldDataChanged: function(e) {
                if (["recycleGlass","recyclePaper"].includes(e.dataField)) {
                e.component.updateData(e.dataField, e.value ? "True" : "False");
            }},
                              onContentReady: function(e) {
                // apply after the form is fully rendered
                $(e.element)
                  .find(".dx-item.dx-box-item")
                  .eq(0) // first group wrapper, adjust index if needed
                  .css("margin-bottom", "60px");

        //               $(e.element)
        // .find(".dx-item.dx-box-item")
        // .eq(3)
        // .css("margin-bottom", "-80px");
            },
            cssClass: "tight-form",
            items: [
                {
                    itemType: "group",
                    // caption: "Edit Office Information",
                    colCount: 4,
          
                    cssClass: "edit-office-group", // custom class for the first group
                    items: [
                        {
                                dataField: "officeID",
                            label: { text: "Office ID" },
                            colSpan: 4,
                                editorOptions: {
                width: 163,readOnly: true   // set width in px or %
        }
                        },
                            { dataField: "adpWorkCode", label: { text: "Adp Work Code" } },
                            { dataField: "visionCode", label: { text: "Vision Code" }},
                            { dataField: "adpHeadCount", label: { text: "Adp Head Count" } },
                            { dataField: "visionHeadCount", label: { text: "Vision Head Count" } },
                            { dataField: "ohPhase", label: { text: "OH Phase" } },
                            { dataField: "ohPhase2", label: { text: "OH Phase 2" } },
                            { dataField: "ohPhase3", label: { text: "OH Phase 3" } },
                            { dataField: "ohPhase4", label: { text: "OH Phase 4" } },
                                    { dataField: "comments", editorType: "dxTextArea", colSpan: 4,editorOptions: {
            height: 45
        },
        cssClass: "no-scroll-textarea" }
                    ]
                },
                {
                    itemType: "group",
                    caption: "Location Information",
                    colCount: 4,
                    items: [
                             // row 1
                    { dataField: "Street" },
                        { dataField: "addressLine1", label: { text: "Address line 1" },colSpan:2 },
                        { dataField: "addressLine2", label: { text: "Address line 2" } },
                    // { dataField: "City" },
                    // row 2
                            { dataField: "postalCode" ,label:{text:"Zip"}},
                            { dataField: "stateProvince",label:{text:"State"} },
                                {
            dataField: "country",
            editorType: "dxSelectBox",
            editorOptions: {
                    dataSource: ["Canada", "China", "India", "United Kingdom", "United States"],
            //value: "India",   // default selected value
            searchEnabled: true // optional: allows searching in dropdown
            }
        },

                        { dataField: "yearBuilt" },
                    // row 3
                        // { dataField: "primFun" },
                                {
            dataField: "PrimFun",
            editorType: "dxSelectBox",
            editorOptions: {
                dataSource: new DevExpress.data.CustomStore({
                    loadMode: "raw",
                    load: function () {
                        return $.getJSON("/Home/GetPrimFunList");
                    }
                }),
                    value: "@Model.PrimFun", // shows saved value in edit
                searchEnabled: true
            }
        },

                        //{ dataField: "egridSubregion", label: { text: "eGRID Subregion" } },
                                {
            dataField: "eGRIDSubregion",
            editorType: "dxSelectBox",
            editorOptions: {
                dataSource: new DevExpress.data.CustomStore({
                    loadMode: "raw",
                    load: function () {
                        return $.getJSON("/Home/GetEgridSubregions");
                    }
                }),
                    value: "@Model.EGRIDSubregion", // show saved value in edit mode
                searchEnabled: true,
                placeholder: "Select eGRID Subregion"
            }
        },

                        //{ dataField: "climateZone" },
                                {
            dataField: "ClimateZone",
            editorType: "dxSelectBox",
            editorOptions: {
                dataSource: new DevExpress.data.CustomStore({
                    loadMode: "raw",
                    load: function () {
                        return $.getJSON("/Home/GetClimateZones");
                    }
                }),
                value: "@Model.ClimateZone", // auto-select saved value in edit mode
                searchEnabled: true,
                placeholder: "Select Climate Zone"
            }
        },

                        //{ dataField: "htgFuel" },
                                {
            dataField: "htgfuel",
            editorType: "dxSelectBox",
            editorOptions: {
                dataSource: new DevExpress.data.CustomStore({
                    loadMode: "raw",
                    load: function () {
                        return $.getJSON("/Home/GetHtgFuels");
                    }
                }),
                    value: "@Model.HTGFuel", // preselect saved value in edit mode
                searchEnabled: true,
                placeholder: "Select Heating Fuel"
            }
        },

                    // row 4
                        { dataField: "officeSF" },
                        { dataField: "netOfficeSF" },
                                {
            dataField: "leaseCommenceDate",
            label: { text: "Lease Commence Date" },
            editorType: "dxDateBox",
            editorOptions: {
                displayFormat: "dd/MM/yyyy",
                type: "date",
                width: "100%"
            }
        },
        {
            dataField: "leaseExpirationDate",
            label: { text: "Lease Expiration Date" },
            editorType: "dxDateBox",
            editorOptions: {
                displayFormat: "dd/MM/yyyy",
                type: "date",
                width: "100%"
            }
        },
        {
            dataField: "leaseTermDate",
            label: { text: "Lease Termination Date" },
            editorType: "dxDateBox",
            editorOptions: {
                displayFormat: "dd/MM/yyyy",
                type: "date",
                width: "100%"
            }
        },
                                {
            dataField: "lastSurveyDate",
            label: { text: "Lease Survey date" },
            editorType: "dxDateBox",
            editorOptions: {
                displayFormat: "dd/MM/yyyy",   // choose format you like
                type: "date",                 // ensures calendar picker
                width: "100%"                 // optional
            }
        },
                        //{ dataField: "energyDataSource" },
                                {
            dataField: "EnergyDataSource",
            editorType: "dxSelectBox",
            editorOptions: {
                dataSource: new DevExpress.data.CustomStore({
                    loadMode: "raw",
                    load: function () {
                        return $.getJSON("/Home/GetEnergyDataSources");
                    }
                }),
                value: "@Model.EnergyDataSource", // auto-select saved value in edit mode
                searchEnabled: true,
                placeholder: "Select Energy Data Source"
            }
        },

                   // { dataField: "Status" },
                          

                    // row 6
                                { dataField: "estimateElectricUsageBool", editorType: "dxCheckBox", label: { text: "Estimate Electric Usage" },cssClass: "mt-estimate-electric" },
                                { dataField: "estimateGasUsageBool", editorType: "dxCheckBox", label: { text: "Estimate Gas Usage" },cssClass: "mt-estimate-electric" },
                        { dataField: "acquisition" },
                        { dataField: "earthDay" },
                             {itemType: "empty",colSpan: 1 },
                            //     {itemType: "empty",colSpan: 1 },
                            //     {itemType: "empty",colSpan: 1 },
                    // comments full row
                                { dataField: "comments1", editorType: "dxTextArea",label:{text:"Location Comments"}, colSpan: 4 ,editorOptions: {
                height: 45
            },
            cssClass: "no-scroll-textarea" },

                                 { dataField: "energyThermostatsBool", editorType: "dxCheckBox", label: { text: "Smart Thermostats" } },
                                    { dataField: "energyStarAppliancesBool", editorType: "dxCheckBox", label: { text: "Energy Star Rated Appliances" } },
                                    { dataField: "energyBanSpaceHeatersBool", editorType: "dxCheckBox", label: { text: "Ban On Personal Heaters" } },
                                    { dataField: "energySolarOnsiteBool", editorType: "dxCheckBox", label: { text: "Solar Panels On Site" } },
                                    { dataField: "energyLED_LightingBool", editorType: "dxCheckBox", label: { text: "Energy LED Lighting" } },
                                    { dataField: "energyMotionLightingBool", editorType: "dxCheckBox", label: { text: "Energy Motion Lighting" } },
                                    { dataField: "energyCopiersAutoOffBool", editorType: "dxCheckBox", label: { text: "Energy Copiers Auto-Off" } },
                                    { dataField: "energyEV_ChargersBool", editorType: "dxCheckBox", label: { text: "Energy EV Chargers" } }
                    ]
                    },  {
                    itemType: "group",
                    caption: "Locations",
                    colCount: 4,
                    items: [
                            //{ dataField: "status" },
                                 {
                dataField: "Status",
                editorType: "dxSelectBox",
                editorOptions: {
                    dataSource: ["New", "Open", "Closed"],
                        value: "@Model.Status",
                    searchEnabled: false,   // no need to search for just 3 values
                    placeholder: "Select Status"
                }
            },
                        { dataField: "Address" ,colSpan:2 },
                            { dataField: "city" }
                    ]
                },
                     {
                itemType: "group",
                caption: "Recycle Items",
                colCount: 5,
                    cssClass: "recycle-group",
                items: [
                                     { dataField: "recyclePaperBool", editorType: "dxCheckBox", label: { text: "Recycle Paper" } },                               
                                { dataField: "recyclePlasticBool", editorType: "dxCheckBox", label: { text: "Recycle Plastic" } },
                            { dataField: "recycleAluminumCansBool", editorType: "dxCheckBox", label: { text: "Recycle Aluminum Cans" } },
                            { dataField: "recycleEWasteBool", editorType: "dxCheckBox", label: { text: "Recycle E-Waste" } },
                            { dataField: "recycleCardboardBool", editorType: "dxCheckBox", label: { text: "Recycle Cardboard" } },
                            { dataField: "recycleCompostBool", editorType: "dxCheckBox", label: { text: "Recycle Compost" } },
                            { dataField: "recycleBatteriesBool", editorType: "dxCheckBox", label: { text: "Recycle Batteries" } },
                            { dataField: "waterDataBool", editorType: "dxCheckBox", label: { text: "Water Data" } },
                                        {
            dataField: "recycleGlass",
            editorType: "dxCheckBox",
            label: { text: "Recycle Glass" },
            editorOptions: {
                trueValue: "TRUE",     // what to send when checked
                falseValue: "FALSE",   // what to send when unchecked
                value: formData.recycleGlass  // current value
            }
        }


                ]
            },

                {
                itemType: "group",
                colCount: 2,   // two columns side by side
                cssClass: "form-buttons-row",
                items: [
                    
                    {
                itemType: "button",
                cssClass: "btn-cancel",
                //horizontalAlignment: "right",
                buttonOptions: {
                    text: "Cancel",
                    type: "normal",
                    onClick: function() {
                        DevExpress.ui.notify("Cancelled", "warning", 2000);
                        // Example: redirect or clear form
                         window.location.href = "/Home/Index";
                    }
                }
            }
                ]
            }
                 
            ]
        });
            


        $("#saveBtn").dxButton({
            text: "Save",
            type: "success",
            onClick: function () {
                const formData = $("#formContainer").dxForm("instance").option("formData");
                $.ajax({
                    url: "/Home/UpdateOffice",
                    method: "POST",
                    contentType: "application/json",
                    data: JSON.stringify(formData),
                    success: function () {debugger;
                        //DevExpress.ui.notify("Updated successfully", "success", 2000);
                                DevExpress.ui.notify({
            message: "Updated successfully",
            type: "success",
            displayTime: 2000,
            position: {
                my: "center",    // where toast aligns itself
                at: "center",    // where on the screen
                of: window       // relative to the window
            }
        });

                        //window.location.href = "/Home/Index"; // or wherever you want to go
                                setTimeout(function () {
            window.location.href = "/Home/Index";
        }, 5000);
                    }
                });
            }
        });
    });
</script>



    <style>
        .dx-list-item-content {
            font-size: x-small !important;
        }
        h3 {
            margin-top: -10px;
            margin-bottom: 15px;
            margin-left: 35px;
        }

        .card-box {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06); /* soft outer shadow */
            padding: 20px;
            border: 1px solid rgba(0, 0, 0, 0.04); /* light border */
            height: 1200px !important;
            margin-left: 30px;
            margin-right: 30px;
        }
        .mt-estimate-electric {
            margin-top: -15px; /* adjust as needed */
        }
        .btn-cancel {
            margin-right: -100px;
            margin-bottom:-40px;
        }
        .recycle-group {
            margin-top: -75px; /* example */
        }
        .no-scroll-textarea textarea {
            overflow-y: hidden !important;
        }

        /* remove default margin between groups */
        .tight-form .edit-office-group {
            margin-bottom: -350px !important;
            padding-bottom: 0 !important;
            
        }        


        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            padding-left: 50px;
            padding-right: 50px;
            background-color: black;
        }

        /* Top dark bar with logo */
        .top-bar {
            /* background-color: #26004d;  Very dark purple */
            background-color: #2e0055; /* Slightly lighter purple */
            height: 60px;
            display: flex;
            align-items: center;
            padding-left: 20px;
        }

        .logo {
            height: 35px;
        }

        /* Bottom nav bar with title and menu */
        .nav-bar {
            /*background-color: #2e0055;  Slightly lighter purple */
            /*background-color: #26004d;  Very dark purple */
            background-color: black;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 5px 20px;
            border-top: 1px solid #4f2d70;
        }
        
        .card-box {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06); /* soft outer shadow */
            padding: 20px;
            /* border: 1px solid rgba(0, 0, 0, 0.04); */ /* light border */
            height: 800px;
        }

            .card-box label {
                /* font-weight: 600; */
                display: block;
               /*  margin-bottom: 8px; */
                color: #111;
                font-size:x-small;
            }

            .card-box select {
                width: 100%;
                padding: 10px 12px;
                font-size: 14px;
                border-radius: 6px;
                /* border: 1px solid #ccc; */
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08); /* subtle dropdown shadow */
            }


        .app-title {
            color: white;
            font-size: 15px;
        }

        .nav-links {
            display: flex;
            gap: 20px;
            padding-right: 550px;
        }

            .nav-links a {
                color: white;
                text-decoration: none;
                /* font-size: 14px; */
                font-size: x-small;
            }

                .nav-links a.active {
                    font-weight: bold;
                    text-decoration: underline;
                }

        .dx-dropdowneditor.dx-dropdowneditor-field-clickable, .dx-dropdowneditor.dx-dropdowneditor-field-clickable .dx-texteditor-input {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06); /* soft outer shadow */
            border: 1px solid rgba(0, 0, 0, 0.04); /* light border */
            height: 20px !important;
        }

        .dx-texteditor-input {
            height: 20px !important;
            min-height:20px !important;
            font-size:smaller !important;
        }

            /* .dx-texteditor-input#comments {
                height: 45px !important;
            } */
        label {
            font-size: small;
        }

        /* Style the DevExtreme DataGrid header row */
        .dx-datagrid .dx-header-row {
            background-color: #673A91 !important; /* Deep purple */
            color: white !important; /* White text */
            font-weight: bold !important; /* Bold text */
        }

        /* .dx-item {margin-bottom:-610px !important;} */
        .mb-20 {
            /* margin-bottom: -610px !important; */
        }


            /* Optional: Style individual header cells */
            .dx-datagrid .dx-header-row > td {
                /* border: 1px solid white; */ /* White cell borders (optional) */
            }

        * {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        .settings,
        .user {
            margin-left: 15px;
            background: #4c2671;
            padding: 5px 10px;
            border-radius: 50%;
            text-align: center;
        }

       /*  .main-container {
            padding: 30px;
            background-color: white;
            height: 1200px;
        } */
        .main-container {
            padding: 30px;
            background-color: #d3d3d3;
            /* background-color: #e0e0e0; */
            /* background-color: #f5f5f5; */
            /* background-color: white; */
            height: 1300px;
        }

        h1 {
            font-size: 24px;
           /*  margin-bottom: 20px; */
        }

        .filters {
            display: flex;
            gap: 20px;
           /*  margin-bottom: 20px; */
        }

            .filters label {
                display: flex;
                flex-direction: column;
                font-weight: bold;
            }

        select {
            padding: 8px;
            width: 280px;
            margin-top: 5px;
        }

        .table-container {
            background: white;
            /* border: 1px solid #ddd; */
            border-radius: 8px;
            overflow-x: auto;
            padding: 20px;
        }

        .table-actions {
            display: flex;
            justify-content: space-between;
            /* margin-bottom: 15px; */
        }

            .table-actions input {
                padding: 8px;
                width: 200px;
            }

        .add-btn {
            padding: 8px 16px;
            background-color: #6a0dad;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #5d3a8a;
            color: white;
        }

        th, td {
            padding: 10px;
            /* border: 1px solid #ddd; */
            text-align: left;
            font-size: x-small;
        }

        a {
            color: #0044cc;
            text-decoration: none;
        }

        .pagination {
            margin-top: 10px;
            text-align: right;
            font-weight: bold;
        }
        
    </style>
    </body>
    </html>
